<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>File.OpenWrite Gotcha - The Endless Obsession
    </title>
    <meta name="author" content="Bryan Matthews">
    <meta name="description" content="The personal blog of Bryan Matthews"><!-- Viewport and Media Queries: http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="http://endlessobsession.com" rel="canonical">
    <link href="/infinity-symbol.png" rel="icon">
    <link href="/atom.xml" rel="alternate" type="application/atom+xml" title="The Endless Obsession">
    <link href="/stylesheets/normalize-3.0.2.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/layout.css?v=1.0.0" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/theme.css?v=1.0.0" media="screen, projection" rel="stylesheet" type="text/css">
  </head>
  <body>
    <header role="banner">
      <hgroup>
        <h1><a href="http://endlessobsession.com">The Endless Obsession</a></h1><small>better code</small>
      </hgroup>
      <nav role="complementary">
        <ul>
          <li><a href="/atom.xml" title="RSS">RSS</a></li>
          <li><a href="https://github.com/mattheyan" title="Github: mattheyan" target="_blank">Github</a></li>
          <li><a href="https://twitter.com/BryanMatthews" title="Twitter: @BryanMatthews" target="_blank">Twitter</a></li>
        </ul>
      </nav>
    </header>
    <nav role="navigation">
      <ul>
        <li><a href="http://endlessobsession.com">Home</a></li>
        <li><a href="http://endlessobsession.com/about" rel="author">About</a></li>
        <li><a href="http://endlessobsession.com/blog/archives">Archives</a></li>
      </ul>
      <form action="http://google.com/search">
        <fieldset role="search">
          <input type="hidden" name="q" value="site:http://endlessobsession.com">
          <input type="text" name="q" results="0" placeholder="Search" class="search">
        </fieldset>
      </form>
    </nav>
    <main>
      <article>
        <header>
          <time datetime="2013-01-03" pubdate>Jan 3rd, 2013</time>
          <h2>File.OpenWrite Gotcha</h2>
        </header>
        <section><p>Recently I ran into an odd problem when writing a text file to disk using .<span class="caps">NET</span>’s <code>File.OpenWrite</code>.</p>
<pre><code>using (var fileWriter = new StreamWriter(File.OpenWrite(outputFilePath)))
{
    fileWriter.WriteLine(&quot;abc&quot;);
}
</code></pre><p>You might expect that after executing this code the text in the file would be “abc”.  Not quite.  In my case I was sometimes seeing results like&nbsp;this…</p>
<pre><code>abc
some other text
</code></pre><p>…where “some other text” is the last bit of text in the file before&nbsp;writing.</p>
<p>It turns out that the <a href="http://msdn.microsoft.com/en-us/library/system.io.file.openwrite.aspx" title="System.IO.File.OpenWrite">documentation for File.OpenWrite</a> contains the&nbsp;answer.</p>
<blockquote>
<p>If you overwrite a longer string (such as “This is a test of the OpenWrite method”) with a shorter string (such as “Second run”), the file will contain a mix of the strings (“Second runtest of the OpenWrite&nbsp;method”).</p>
</blockquote>
<p><code>OpenWrite</code> behaves much like the dreaded insert mode in word processors and text&nbsp;editors.</p>
<p>The solution that I chose is pretty simple.  Just <a href="http://stackoverflow.com/questions/2695444/clearing-content-of-text-file-using-c-sharp" title="Stack Overflow - Clearing content of text file using C#">clear the file’s contents</a>&nbsp;beforehand.</p>
</section>
        <section>
          <h2>Comments</h2>
          <div id="disqus_thread"></div>
        </section>
      </article>
    </main>
    <footer>
      <div class="nav"><a href="/">« Full blog</a></div>
      <script type="text/javascript" src="/javascripts/disqus.js?v=2.0.0&amp;name=endlessobsession"></script><small>Copyright &copy; 2015 - Bryan Matthews &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a></small>
      <script type="text/javascript" src="/javascripts/analytics.js?v=1.0.0&amp;id=UA-17782995-1"></script>
    </footer>
  </body>
</html>