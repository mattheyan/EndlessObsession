<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>The Endless Obsession
    </title>
    <meta name="author" content="Bryan Matthews">
    <meta name="description" content="The personal blog of Bryan Matthews"><!-- Viewport and Media Queries: http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="http://endlessobsession.com" rel="canonical">
    <link href="/infinity-symbol.png" rel="icon">
    <link href="/atom.xml" rel="alternate" type="application/atom+xml" title="The Endless Obsession">
    <link href="/stylesheets/normalize-3.0.2.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/layout.css?v=1.0.0" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/theme.css?v=1.0.0" media="screen, projection" rel="stylesheet" type="text/css">
  </head>
  <body>
    <header role="banner">
      <hgroup>
        <h1><a href="http://endlessobsession.com">The Endless Obsession</a></h1><small>better code</small>
      </hgroup>
      <nav role="complementary">
        <ul>
          <li><a href="/atom.xml" title="RSS">RSS</a></li>
          <li><a href="https://github.com/mattheyan" title="Github: mattheyan" target="_blank">Github</a></li>
          <li><a href="https://twitter.com/BryanMatthews" title="Twitter: @BryanMatthews" target="_blank">Twitter</a></li>
        </ul>
      </nav>
    </header>
    <nav role="navigation">
      <ul>
        <li><a href="http://endlessobsession.com">Home</a></li>
        <li><a href="http://endlessobsession.com/about" rel="author">About</a></li>
        <li><a href="http://endlessobsession.com/blog/archives">Archives</a></li>
      </ul>
      <form action="http://google.com/search">
        <fieldset role="search">
          <input type="hidden" name="q" value="site:http://endlessobsession.com">
          <input type="text" name="q" results="0" placeholder="Search" class="search">
        </fieldset>
      </form>
    </nav>
    <main>
      <section>
        <article>
          <header>
            <time datetime="2010-06-10" pubdate>Jun 10th, 2010</time>
            <h2><a rel="article" href="/blog/pdf-embed-weirdness">PDF Embed Weirdness</a></h2>
          </header>
          <section><p><em>Originally posted April 5&nbsp;2010</em></p>
<p>The other day I was working on a web page where the user does some stuff and then as the result a nice, shiny <span class="caps">PDF</span> is embedded in the page.  I noticed that in Internet Explorer (I was using IE8) the embedded region showed up as a blank rectangle with a little icon in the upper left-hand corner.&nbsp;Weird…</p>
<p>One of my co-workers suggested that I try embedding a static <span class="caps">PDF</span> file.  In my case the source URL was an aspx page that dynamically renders the PDF.  But that can’t possibly matter, right?  I mean, as long as the content type is correct and the file is intact.  I guess it&nbsp;does.</p>
<p>I won’t bore you with the details, but I determined through trial and error that the following conditions had to be met for the embedded <span class="caps">PDF</span> to display in&nbsp;IE8:</p>
<p>1)  The “type” attribute must be specified as “application/pdf”, regardless of the fact that the external resource has the correct content type header.  Because of my own ignorance I freely accept that there is probably a good reason for this.  Besides, its good practice anyway – especially in my case (“what does this Page.aspx render&nbsp;as???”).</p>
<p>2)  The <span class="caps">URL</span> must include “pdf” or “.pdf” (not sure if the “.” is necessary), even if on the query string!  Really?  I didn’t believe it myself, but I tested a gratuitous number of times and eventually disbelief gave way to sheer&nbsp;exhaustion.</p>
<p>3)  Embed tag must be injected into the page with all attribute values at once (using jQuery) rather than injecting the tag and then setting attribute values (like type and src).  This may be a jQuery issue, but its worth mentioning&nbsp;anyway.</p>
<p>So, the moral of the story&nbsp;is…</p>
<p>If it doesn’t work then first reduce the problem to its simplest&nbsp;form.</p>

          </section>
        </article>
      </section>
      <section>
        <article>
          <header>
            <time datetime="2010-02-10" pubdate>Feb 10th, 2010</time>
            <h2><a rel="article" href="/blog/wheres-my-desktop">Where's My Desktop!</a></h2>
          </header>
          <section><p>The other day I got into work really early, hoping to have a productive morning.  Unfortunately, my computer had other ideas.  When it finished booting up I was greeted by an empty desktop and a host of applications complaining about needing a password.  Geez, I don’t even have coffee yet, how am I supposed to deal with this?!  (not that I drink&nbsp;coffee…)</p>
<p>Anyway, being the lazy developer that I am, I promptly notified the <span class="caps">IT</span> staff and then fired up Google.  I found a few posts mentioning the fact that my profile was mapped to a different location on disk (C:\windows\system32\config\systemprofile), but not much in the way of an explanation.  They suggested copying files into that location, but that didn’t seem like a good idea to me.  Eventually I was contacted by one of my helpful coworkers who helped me resolve the issue by running the disk error checking utility (chkdsk.exe) and rebooting.  Simple,&nbsp;huh?</p>
<p>So, what did I learn from all of this?  Apparently, if Windows discovers that your profile is corrupted it will allow you to log in using a temporary profile so that you can fix the problem.  Running chkdsk (with both options selected) may work, as it did for me, or it may also be possible to backup your files and have Windows regenerate some of the files that may be corrupt (but don’t take my word for&nbsp;it).</p>
<p>I’ll keep that info filed away for future reference, but I will probably never have this problem again <em>crosses fingers</em>…</p>

          </section>
        </article>
      </section>
      <section>
        <article>
          <header>
            <time datetime="2010-02-10" pubdate>Feb 10th, 2010</time>
            <h2><a rel="article" href="/blog/encryption-and-varbinary">Encryption and VARBINARY</a></h2>
          </header>
          <section><p>Data loss is a scary thing.  In one of the apps I have worked on it is particularly scary since some of the data is encrypted.  In the beginning it was encrypted in such a way that it would be (hopefully) impossible to retrieve without the proper authorization.  Essentially, the data would be junk if a finite number of users forgot their passwords.  This was always lurking in the back of my mind.  (You’ve never forgotten your password, have you?)  Luckily we dropped that approach, but I didn’t anticipate how we would actually lose&nbsp;data.</p>
<p>One day I discovered an interesting error was occurring.  (Only in hindsight can I refer to it as “interesting”.)  It was a <em>CryptographicException</em>:  Length of the data to decrypt is invalid.  The application was attempting to load some encrypted data from the database and was repeatedly failing on a particular record.  This is not&nbsp;good.</p>
<p>At first I thought:  “Maybe there is a character or combination of characters in the source text that is causing the problem.”  Looking back I can see that it was a poor attempt at an explanation.  To be fair, I was alerted to the problem by a user who also informed me that he had used a random text generation feature (possibly for the first time), so I was a little biased.  I was able to verify that the data was an odd size (as expected) and the encryption algorithm expected blocks of a certain number of bytes.  However, I could not reproduce the bug since I had no idea what the original source text&nbsp;was.</p>
<p>Fast-forward a week or two.  The problem occurs again, but this time the user is working with a known value.  I crack open the test system and, lo and behold, the error is reproducible!  After doing some debugging and tracing I come to the conclusion that <span class="caps">SQL</span> Server is truncating my data.  (How rude!?)  From there it didn’t take long for me to discover an interesting property of the column in question.  Getting info on the table told me that the “TrimTrailingSpace” property was true (which corresponds to <a href="http://msdn.microsoft.com/en-us/library/ms187403.aspx"><em><span class="caps">ANSI</span> PADDING</em></a>).  It doesn’t take a genius to figure out that something is wrong with&nbsp;that.</p>
<p>Luckily I found <a href="http://support.microsoft.com/kb/296559"><em>this article</em></a>, which indicates that any alter of the column will turn off “TrimTrailingSpace”, just what I wanted.  So, what did I do?  Something like&nbsp;this:</p>
<p><span class="caps">ALTER</span> TABLE MyTable
ALTER COLUMN MyColumn&nbsp;VARBINARY(xxx);</p>
<p>Problem&nbsp;solved!</p>

          </section>
        </article>
      </section>
      <section>
        <article>
          <header>
            <time datetime="2010-02-10" pubdate>Feb 10th, 2010</time>
            <h2><a rel="article" href="/blog/the-new-asp-net-ajax-part-1-getting-started-with-the-script-loader">The New ASP.NET AJAX: Part 1 - Getting Started with the Script Loader</a></h2>
          </header>
          <section><p><strong>Background</strong>:  I had an existing <span class="caps">ASP</span>.NET AJAX-enabled application and wanted to use the Script Manager control in conjunction with the new client-only Script Loader.  I wasn’t quite sure how they would work together and there is (understandably) precious little in the way of documentation.  Here is what I have found so far…<br><em>By the way, if you haven’t heard of the Script Loader then you can read about it </em><a href="http://weblogs.asp.net/scottgu/archive/2009/10/15/announcing-microsoft-ajax-library-preview-6-and-the-microsoft-ajax-minifier.aspx"><em>here</em></a><em> and </em><a href="http://weblogs.asp.net/bleroy/archive/2009/11/23/enabling-the-asp-net-ajax-script-loader-for-your-own-scripts.aspx"><em>here</em></a><em>, or Google it (with&nbsp;Bing…)!</em></p>

            <p><a rel="more" href="/blog/the-new-asp-net-ajax-part-1-getting-started-with-the-script-loader">Continue reading</a></p>
          </section>
        </article>
      </section>
      <nav role="navigation">
        <ul>
          <li><a rel="prev" href="/blog/page/3/">Newer</a></li>
          <li><a rel="archives" href="/blog/archives">Archives</a></li>
        </ul>
      </nav>
    </main>
    <footer><small>Copyright &copy; 2015 - Bryan Matthews &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a></small>
      <script type="text/javascript" src="/javascripts/analytics.js?v=1.0.0&amp;id=UA-17782995-1"></script>
    </footer>
  </body>
</html>