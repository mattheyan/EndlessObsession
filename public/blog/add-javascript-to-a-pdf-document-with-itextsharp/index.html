
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Add JavaScript to a PDF Document with iTextSharp - The Endless Obsession</title>
  <meta name="author" content="Bryan Matthews">

  
  <meta name="description" content="Originally posted June 8 2010 As you might have guessed from the title, this post is of the “get it done” variety.  So, the code may be a little &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://endlessobsession.com/blog/add-javascript-to-a-pdf-document-with-itextsharp">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="The Endless Obsession" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-17782995-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">The Endless Obsession</a></h1>
  
    <h2>better code</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:endlessobsession.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <!--<li><a href="/guides">Guides</a></li>-->
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Add JavaScript to a PDF Document With iTextSharp</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-10T18:58:00-04:00" pubdate data-updated="true">Jun 10<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><em>Originally posted June 8 2010</em></p>

<p>As you might have guessed from the title, this post is of the “get it done” variety.  So, the code may be a little rough.  Its the sort of code that works, but isn’t fully understood (by me at least).  I wasn’t able to find a clear example on the net, so I pieced together examples and guesses based on reading the code and interpreting method and class names.</p>

<p>Why guess?  Well, <a href="http://sourceforge.net/projects/itextsharp/">iTextSharp</a> is a pretty robust open source project which is useful for creating and manipulating PDF documents.  The problem is, it doesn’t seem to have any useful documentation online.  It <strong><em>is</em></strong> open source, so you can read the code all day.  Also, there are some tutorials that you can download from the <a href="http://sourceforge.net/projects/itextsharp/files/">files page</a> (in the examples folder).</p>

<p>The goal was to have a PDF document print automatically from a web page.  I decided to pass on coming up with a cross-browser (read: works in IE) method for automatically printing the document on the client, and instead decided to insert JavaScript into the generated PDF document that would cause it to print when opened.  This is what I came up with.</p>

<p>PdfReader reader = new PdfReader(inputStreamOrFile);</p>

<p>int pageCount = reader.NumberOfPages;</p>

<p>Rectangle pageSize = reader.GetPageSize(1);</p>

<p>// Setup writer</p>

<p>PdfDocument document = new PdfDocument(pageSize);</p>

<p>PdfWriter writer = PdfWriter.GetInstance(document, outputStreamOrFile);</p>

<p>document.Open();</p>

<p>// Copy each page</p>

<p>PdfContentByte content = writer.DirectContent;</p>

<p>for (int i = 0; i &lt; pageCount; i++)</p>

<p>{</p>

<p>document.NewPage();</p>

<p>PdfImportedPage page = writer.GetImportedPage(reader, i + 1); // page numbers are one-based</p>

<p>content.AddTemplate(page, 0, 0); // x and y correspond to position on the page?</p>

<p>}</p>

<p>// Insert JavaScript to print the document after a fraction of a second (allow time to become visible).</p>

<p>string jsText = &#8220;var res = app.setTimeOut(&#8216;var pp = this.getPrintParams();pp.interactive = pp.constants.interactionLevel.full;this.print(pp);&#8217;, 200);&#8221;;</p>

<p>//string jsTextNoWait = &#8221;var pp = this.getPrintParams();pp.interactive = pp.constants.interactionLevel.full;this.print(pp);&#8221;;</p>

<p>PdfAction js = PdfAction.JavaScript(jsText, writer);</p>

<p>writer.AddJavaScript(js);</p>

<p>document.Close()</p>

<p>As for the JavaScript, the call to setTimeOut is there so that the PDF is rendered before the print dialog is shown.  Otherwise, the users will see the print dialog and a blank page, which may be confusing.  If the PDF is not visible anyway (as in my case) then you don’t really need the timeout.  The actual printing is based on the documentation of Acrobat JavaScript from <a href="http://livedocs.adobe.com/acrobat_sdk/9.1/Acrobat9_1_HTMLHelp/wwhelp/wwhimpl/js/html/wwhelp.htm?href=JS_API_AcroJSPreface.87.6.html&amp;accessible=true">Adobe’s website</a>.  In this example, the <a href="http://livedocs.adobe.com/acrobat_sdk/9.1/Acrobat9_1_HTMLHelp/wwhelp/wwhimpl/js/html/wwhelp.htm?href=JS_API_AcroJSPreface.87.6.html&amp;accessible=true">iteration level</a> is set to “full”, meaning that the user will get the print dialog and progress feedback.  You can also use “automatic” (no dialog, includes progress) and “silent” (no dialog or progress).</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Bryan Matthews</span></span>

      








  


<time datetime="2010-06-10T18:58:00-04:00" pubdate data-updated="true">Jun 10<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/pdf/'>pdf</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://endlessobsession.com/blog/add-javascript-to-a-pdf-document-with-itextsharp" data-via="BryanMatthews" data-counturl="http://endlessobsession.com/blog/add-javascript-to-a-pdf-document-with-itextsharp" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/pdf-embed-weirdness" title="Previous Post: PDF Embed Weirdness">&laquo; PDF Embed Weirdness</a>
      
      
        <a class="basic-alignment right" href="/blog/tiny-mce-spellchecker-gotcha" title="Next Post: Tiny MCE Spellchecker Gotcha">Tiny MCE Spellchecker Gotcha &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/octopress-post-excerpts-and-couldnt-parse-yaml">Octopress post excerpts and 'couldn't parse YAML'</a>
      </li>
    
      <li class="post">
        <a href="/blog/file-dot-openwrite-gotcha">File.OpenWrite Gotcha</a>
      </li>
    
      <li class="post">
        <a href="/blog/chrome-select-excessive-padding">Chrome select excessive padding</a>
      </li>
    
      <li class="post">
        <a href="/blog/should-you-write-awesome-code">Should you write awesome code?</a>
      </li>
    
      <li class="post">
        <a href="/blog/carolina-code-camp-2012-presentation">Carolina Code Camp 2012 Presentation</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/mattheyan">@mattheyan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'mattheyan',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("BryanMatthews", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/BryanMatthews" class="twitter-follow-button" data-show-count="false">Follow @BryanMatthews</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/mattheyan?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Bryan Matthews -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'endlessobsession';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
