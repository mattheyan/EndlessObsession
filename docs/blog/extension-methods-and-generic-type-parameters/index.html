<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Extension Methods and Generic Type Parameters - Endless Obsession | Bryan Matthews</title><meta name="author" content="Bryan Matthews"><meta name="description" content="The personal blog of Bryan Matthews"><!-- Viewport and Media Queries: http://t.co/dKP3o1e --><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://mattheyan.github.io/EndlessObsession/" rel="canonical"><link href="https://mattheyan.github.io/EndlessObsession/infinity-symbol.png" rel="icon"><link href="https://mattheyan.github.io/EndlessObsession/atom.xml" rel="alternate" type="application/atom+xml" title="Endless Obsession"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link href="https://mattheyan.github.io/EndlessObsession/stylesheets/theme-3.0.css" media="screen, projection" rel="stylesheet" type="text/css"><link href="https://mattheyan.github.io/EndlessObsession/stylesheets/tomorrow.css" media="screen, projection" rel="stylesheet" type="text/css"></head><body><div><header role="banner"><hgroup><h1><a href="https://mattheyan.github.io/EndlessObsession/">Endless Obsession</a></h1><small>better code</small></hgroup><nav role="navigation"><ul><li><a href="https://mattheyan.github.io/EndlessObsession/">Home</a></li><li><a href="https://mattheyan.github.io/EndlessObsession/about" rel="author">About</a></li><li><a href="https://mattheyan.github.io/EndlessObsession/blog/archives">Blog</a></li></ul><form action="https://google.com/search"><fieldset role="search"><input type="hidden" name="q" value="site:https://mattheyan.github.io/EndlessObsession/"><input class="search" type="text" name="q" results="0" placeholder="Search" autocomplete="off"></fieldset></form></nav><nav role="complementary"><ul><li><a href="https://mattheyan.github.io/EndlessObsession/atom.xml" title="RSS">RSS</a></li><li><a href="https://github.com/mattheyan" title="Github: mattheyan" target="_blank">Github</a></li><li><a href="https://twitter.com/BryanMatthews" title="Twitter: @BryanMatthews" target="_blank">Twitter</a></li></ul></nav></header><main><article><header><h2 class="title">Extension Methods and Generic Type Parameters</h2><div class="byline"><span class="author">Bryan Matthews</span><time datetime="2010-06-24" pubdate>Jun 24th, 2010</time></div></header><section><p>Edit 2010-06-29:  <a href="http://stackoverflow.com/questions/3118898/c-extension-method-on-type-with-generic-type-argument">question on&nbsp;stackoverflow</a></p>
<p>Edit 2010-07-01:  <a href="http://stackoverflow.com/questions/3118898/c-extension-method-on-type-with-generic-type-argument/3159532#3159532">question&nbsp;answered</a></p>
<p>This is going to be a short post, and I’ll get right to the&nbsp;point.</p>
<p>I’m looking at ways to improve the consistency, brevity, and readability of some code in the application I’m working on.  The starting code looked something like&nbsp;this:</p>
<pre><code class="language-cs">context.GetGraphType&lt;Bar&gt;().Subscribe&lt;Fizz&gt;(
  (instance, evt) =&gt; e.Execute((Bar)instance.Instance)
);</code></pre>
<p>It breaks down like&nbsp;this:</p>
<ul>
<li>Get some&nbsp;type</li>
<li>Subscribe to an&nbsp;event</li>
<li>When the event happens, do&nbsp;something</li>
</ul>
<p>It just so happens that we have all followed an unspoken convention: an Execute method with a single parameter that is of the type that is subscribing to the event (Bar).  You can imagine that once you have over a dozen of these subscriptions it can start to look a little silly.  More on that&nbsp;later.</p>
<p>So, I wanted to rewrite it to look something like&nbsp;this:</p>
<pre><code class="language-cs"><span class="keyword">typeof</span>(Bar).SubscribeTo&lt;Fizz&gt;(context);</code></pre>
<p>My hope was that it now reads something like “bar subscribes to the fizz event on the given context”, rather than “the context gets the bar type and subscribes to fizz and then does some stuff.”  Hopefully I’m not totally off base here.  I did check with a co-worker and he confirmed my&nbsp;thoughts.</p>
<p>In order to accomplish the above I wanted to make use of an abstract generic base class for the events, something&nbsp;like:</p>
<pre><code class="language-cs">public abstract class Event&lt;T&gt;
{
    public abstract void Execute(T arg);
}</code></pre>
<p>In the example, T is Bar - the type that subscribes to the event.  I implemented the SubscribeTo method as a local extension method.  Unfortunately, I got stuck when I tried to set up a generic type parameter that would be of type Bar.  Something like&nbsp;this:</p>
<pre><code class="language-cs"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> SubscribeTo&lt;TEvent&gt;(<span class="keyword">this</span> Type type, Context context)
    <span class="keyword">where</span> TEvent : Event&lt;the <span class="keyword">value</span> of parameter <span class="number">1</span>&gt;
{
    <span class="comment">// do stuff...</span>
}</code></pre>
<p>If this were possible, one would be able to implement the change I proposed with type checking.  The compiler would verify that Fizz was a subclass of Event<Bar> and the extension method could treat it as&nbsp;such.</p>
<p>Do you know of a way to implement what I have proposed, or an alternative that is very&nbsp;similar?</p>
<p>Back to the convention I mentioned earlier.  In the spirit of utilizing conventions, I ended up using reflection to take advantage of it.  It isn’t checked by the compiler, but we have the next best thing.  The code runs on application start-up and the Execute method is retrieved when the event is subscribed to, not raised.  So, it will fail very early if there is a&nbsp;problem.</p>
</section><section><h2>Comments</h2><div id="disqus_thread"></div></section></article><footer><script type="text/javascript" src="https://mattheyan.github.io/EndlessObsession/javascripts/disqus.js?v=2.0.0&amp;name=endlessobsession"></script><small>Copyright &copy; 2023 - Bryan Matthews &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a></small><script type="text/javascript" src="https://mattheyan.github.io/EndlessObsession/javascripts/analytics.js?v=1.0.0&amp;id=UA-17782995-1"></script></footer></main></div></body></html>