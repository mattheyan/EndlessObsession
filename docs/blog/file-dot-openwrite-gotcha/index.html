<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>File.OpenWrite Gotcha - Endless Obsession | Bryan Matthews</title><meta name="author" content="Bryan Matthews"><meta name="description" content="The personal blog of Bryan Matthews"><!-- Viewport and Media Queries: http://t.co/dKP3o1e --><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://endlessobsession.com/" rel="canonical"><link href="/infinity-symbol.png" rel="icon"><link href="/atom.xml" rel="alternate" type="application/atom+xml" title="Endless Obsession"><link href="/stylesheets/normalize-3.0.2.css" media="screen, projection" rel="stylesheet" type="text/css"><link href="/stylesheets/theme-2.0.css" media="screen, projection" rel="stylesheet" type="text/css"><link href="/stylesheets/tomorrow.css" media="screen, projection" rel="stylesheet" type="text/css"></head><body><div class="container"><header role="banner"><hgroup><h1><a href="https://endlessobsession.com/">Endless Obsession</a></h1><small>better code</small></hgroup><nav role="navigation"><ul><li><a href="https://endlessobsession.com/">Home</a></li><li><a href="https://endlessobsession.com/about" rel="author">About</a></li><li><a href="https://endlessobsession.com/blog/archives">Blog</a></li></ul><form action="https://google.com/search"><fieldset role="search"><input type="hidden" name="q" value="site:https://endlessobsession.com/"><input class="search" type="text" name="q" results="0" placeholder="Search"></fieldset></form></nav><nav role="complementary"><ul><li><a href="/atom.xml" title="RSS">RSS</a></li><li><a href="https://github.com/mattheyan" title="Github: mattheyan" target="_blank">Github</a></li><li><a href="https://twitter.com/BryanMatthews" title="Twitter: @BryanMatthews" target="_blank">Twitter</a></li></ul></nav></header><main><article><header><h2 class="title">File.OpenWrite Gotcha</h2><div class="byline"><span class="author">Bryan Matthews</span><time datetime="2013-01-03" pubdate>Jan 3rd, 2013</time></div></header><section><p>Recently I ran into an odd problem when writing a text file to disk using .<span class="caps">NET</span>’s <code>File.OpenWrite</code>.</p>
<pre><code class="language-cs"><span class="keyword">using</span> (<span class="keyword">var</span> fileWriter = <span class="keyword">new</span> StreamWriter(File.OpenWrite(outputFilePath)))
{
    fileWriter.WriteLine(<span class="string">"abc"</span>);
}</code></pre>
<p>You might expect that after executing this code the text in the file would be “abc”.  Not quite.  In my case I was sometimes seeing results like&nbsp;this…</p>
<pre><code>abc
some other text</code></pre><p>…where “some other text” is the last bit of text in the file before&nbsp;writing.</p>
<p>It turns out that the <a href="http://msdn.microsoft.com/en-us/library/system.io.file.openwrite.aspx" title="System.IO.File.OpenWrite">documentation for File.OpenWrite</a> contains the&nbsp;answer.</p>
<blockquote>
<p>If you overwrite a longer string (such as “This is a test of the OpenWrite method”) with a shorter string (such as “Second run”), the file will contain a mix of the strings (“Second runtest of the OpenWrite&nbsp;method”).</p>
</blockquote>
<p><code>OpenWrite</code> behaves much like the dreaded insert mode in word processors and text&nbsp;editors.</p>
<p>The solution that I chose is pretty simple.  Just <a href="http://stackoverflow.com/questions/2695444/clearing-content-of-text-file-using-c-sharp" title="Stack Overflow - Clearing content of text file using C#">clear the file’s contents</a>&nbsp;beforehand.</p>
</section><section><h2>Comments</h2><div id="disqus_thread"></div></section></article><footer><script type="text/javascript" src="/javascripts/disqus.js?v=2.0.0&amp;name=endlessobsession"></script><small>Copyright &copy; 2022 - Bryan Matthews &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a></small><script type="text/javascript" src="/javascripts/analytics.js?v=1.0.0&amp;id=UA-17782995-1"></script></footer></main></div></body></html>